<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Alex's Gym Tracker</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }

:root {
  --bg:       #0f0f0f;
  --card:     #1c1c1e;
  --card2:    #2c2c2e;
  --accent:   #ff3b30;
  --green:    #30d158;
  --text:     #f2f2f7;
  --sub:      #8e8e93;
  --border:   #3a3a3c;
  --radius:   14px;
}

body {
  background: var(--bg);
  color: var(--text);
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
  min-height: 100vh;
  padding-bottom: 80px;
}

/* â”€â”€ Header â”€â”€ */
.header {
  background: rgba(15,15,15,0.92);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  padding: 52px 20px 16px;
  position: sticky;
  top: 0;
  z-index: 100;
  border-bottom: 1px solid var(--border);
}
.header-top {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
}
.header h1 { font-size: 28px; font-weight: 700; letter-spacing: -0.5px; }
.header .date { font-size: 13px; color: var(--sub); margin-top: 2px; }
.workout-badge {
  background: var(--accent);
  color: #fff;
  font-size: 11px;
  font-weight: 700;
  padding: 4px 10px;
  border-radius: 20px;
  letter-spacing: 0.5px;
  text-transform: uppercase;
  margin-top: 4px;
}

/* â”€â”€ Nav â”€â”€ */
.nav {
  position: fixed;
  bottom: 0; left: 0; right: 0;
  background: rgba(28,28,30,0.95);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-top: 1px solid var(--border);
  display: flex;
  z-index: 100;
}
.nav-btn {
  flex: 1;
  padding: 12px 0 20px;
  border: none;
  background: none;
  color: var(--sub);
  font-size: 10px;
  letter-spacing: 0.3px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  cursor: pointer;
  transition: color 0.15s;
}
.nav-btn.active { color: var(--accent); }
.nav-btn svg { width:22px; height:22px; }

/* â”€â”€ Views â”€â”€ */
.view { display: none; padding: 16px; }
.view.active { display: block; }

/* â”€â”€ Rest day â”€â”€ */
.rest-screen {
  text-align: center;
  padding: 60px 20px;
}
.rest-screen .emoji { font-size: 64px; margin-bottom: 16px; }
.rest-screen h2 { font-size: 28px; font-weight: 700; margin-bottom: 8px; }
.rest-screen p { color: var(--sub); font-size: 16px; line-height: 1.5; }

/* â”€â”€ Summary bar â”€â”€ */
.summary-bar {
  background: var(--card);
  border-radius: var(--radius);
  padding: 14px 16px;
  margin-bottom: 16px;
  display: flex;
  gap: 0;
}
.summary-stat {
  flex: 1;
  text-align: center;
}
.summary-stat + .summary-stat {
  border-left: 1px solid var(--border);
}
.summary-stat .val { font-size: 20px; font-weight: 700; }
.summary-stat .lbl { font-size: 11px; color: var(--sub); margin-top: 2px; }

/* â”€â”€ Exercise card â”€â”€ */
.exercise-card {
  background: var(--card);
  border-radius: var(--radius);
  margin-bottom: 16px;
  overflow: hidden;
}
.exercise-img {
  width: 100%;
  height: 180px;
  object-fit: cover;
  display: block;
  background: var(--card2);
}
.exercise-img-placeholder {
  width: 100%;
  height: 180px;
  background: var(--card2);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 48px;
  color: var(--sub);
}
.exercise-body { padding: 14px 16px; }
.exercise-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 6px;
}
.exercise-name { font-size: 17px; font-weight: 700; line-height: 1.2; flex: 1; }
.muscle-badge {
  background: var(--card2);
  color: var(--sub);
  font-size: 10px;
  font-weight: 600;
  padding: 3px 8px;
  border-radius: 20px;
  margin-left: 8px;
  white-space: nowrap;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.exercise-meta {
  display: flex;
  gap: 12px;
  margin-bottom: 14px;
  flex-wrap: wrap;
}
.meta-chip {
  font-size: 12px;
  color: var(--sub);
  background: var(--card2);
  padding: 3px 9px;
  border-radius: 8px;
}
.meta-chip span { color: var(--text); font-weight: 600; }
.prev-best {
  font-size: 12px;
  color: var(--sub);
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 5px;
}
.prev-best .val { color: var(--green); font-weight: 700; }

/* â”€â”€ Set logger â”€â”€ */
.sets-header {
  display: grid;
  grid-template-columns: 36px 1fr 1fr 36px;
  gap: 6px;
  margin-bottom: 6px;
  padding: 0 2px;
}
.sets-header span {
  font-size: 11px;
  color: var(--sub);
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.sets-header span:first-child { text-align: left; }

.set-row {
  display: grid;
  grid-template-columns: 36px 1fr 1fr 36px;
  gap: 6px;
  margin-bottom: 6px;
  align-items: center;
}
.set-num {
  font-size: 13px;
  color: var(--sub);
  font-weight: 600;
  padding-top: 2px;
}
.set-input {
  background: var(--card2);
  border: 1.5px solid var(--border);
  border-radius: 10px;
  color: var(--text);
  font-size: 16px;
  font-weight: 600;
  padding: 8px 10px;
  text-align: center;
  width: 100%;
  -webkit-appearance: none;
  outline: none;
  transition: border-color 0.15s;
}
.set-input:focus { border-color: var(--accent); }
.set-input::placeholder { color: var(--border); font-weight: 400; font-size: 14px; }
.set-done-btn {
  width: 36px; height: 36px;
  border-radius: 50%;
  border: 1.5px solid var(--border);
  background: none;
  color: var(--sub);
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.15s;
}
.set-done-btn.logged {
  background: var(--green);
  border-color: var(--green);
  color: #fff;
}
.add-set-btn {
  width: 100%;
  margin-top: 6px;
  padding: 8px;
  background: none;
  border: 1.5px dashed var(--border);
  border-radius: 10px;
  color: var(--sub);
  font-size: 13px;
  cursor: pointer;
  transition: all 0.15s;
}
.add-set-btn:active { opacity: 0.6; }

/* â”€â”€ History â”€â”€ */
.history-empty {
  text-align: center;
  padding: 60px 20px;
  color: var(--sub);
}
.history-empty .emoji { font-size: 48px; margin-bottom: 12px; }
.session-group { margin-bottom: 24px; }
.session-date {
  font-size: 13px;
  color: var(--sub);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  margin-bottom: 8px;
  padding: 0 4px;
}
.session-card {
  background: var(--card);
  border-radius: var(--radius);
  margin-bottom: 10px;
  overflow: hidden;
}
.session-card-header {
  padding: 12px 14px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
}
.session-card-header h3 { font-size: 15px; font-weight: 700; }
.session-card-header .session-summary { font-size: 12px; color: var(--sub); margin-top: 2px; }
.session-chevron { color: var(--sub); font-size: 12px; transition: transform 0.2s; }
.session-chevron.open { transform: rotate(90deg); }
.session-detail { display: none; padding: 0 14px 12px; }
.session-detail.open { display: block; }
.session-exercise { margin-bottom: 10px; }
.session-exercise-name { font-size: 13px; font-weight: 600; margin-bottom: 4px; }
.session-sets { display: flex; flex-direction: column; gap: 3px; }
.session-set-row {
  font-size: 12px;
  color: var(--sub);
  display: flex;
  gap: 8px;
}
.session-set-row .set-label { color: var(--sub); min-width: 36px; }
.session-set-row .set-data { color: var(--text); font-weight: 600; }

/* â”€â”€ Progress bar on card â”€â”€ */
.progress-bar-wrap { margin-top: 10px; }
.progress-bar-label {
  display: flex;
  justify-content: space-between;
  font-size: 11px;
  color: var(--sub);
  margin-bottom: 4px;
}
.progress-bar-track {
  height: 4px;
  background: var(--card2);
  border-radius: 4px;
  overflow: hidden;
}
.progress-bar-fill {
  height: 100%;
  background: var(--green);
  border-radius: 4px;
  transition: width 0.3s ease;
}
</style>
</head>
<body>

<!-- Header -->
<div class="header">
  <div class="header-top">
    <div>
      <h1 id="workoutTitle">Loading...</h1>
      <div class="date" id="todayDate"></div>
    </div>
    <div class="workout-badge" id="workoutBadge"></div>
  </div>
</div>

<!-- Views -->
<div class="view active" id="view-today">
  <div id="todayContent"></div>
</div>

<div class="view" id="view-history">
  <div id="historyContent"></div>
</div>

<!-- Nav -->
<nav class="nav">
  <button class="nav-btn active" id="nav-today" onclick="switchTab('today')">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/>
      <line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>
    </svg>
    Today
  </button>
  <button class="nav-btn" id="nav-history" onclick="switchTab('history')">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
    </svg>
    History
  </button>
</nav>

<script>
// â”€â”€ Workout data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const WORKOUTS = {
  1: { // Monday
    name: 'Upper A',
    focus: 'Strength',
    exercises: [
      { name: 'Barbell Bench Press',  muscle: 'Chest',     sets: 4, reps: '6-8',  tempo: '3-0-1-0', rest: '3 min', imgId: 'Barbell_Bench_Press' },
      { name: 'Barbell Rows',         muscle: 'Back',      sets: 4, reps: '6-8',  tempo: '3-0-1-0', rest: '3 min', imgId: 'Bent_Over_Barbell_Row' },
      { name: 'Overhead Press',       muscle: 'Shoulders', sets: 3, reps: '6-8',  tempo: '3-0-1-0', rest: '3 min', imgId: 'Barbell_Shoulder_Press' },
      { name: 'Pull-ups',             muscle: 'Back',      sets: 3, reps: '6-8',  tempo: '3-0-1-0', rest: '2.5 min', imgId: 'Pullups' },
      { name: 'Barbell Curl',         muscle: 'Biceps',    sets: 3, reps: '8-10', tempo: '3-0-1-0', rest: '2 min', imgId: 'Barbell_Curl' },
      { name: 'Skull Crushers',       muscle: 'Triceps',   sets: 3, reps: '8-10', tempo: '3-0-1-0', rest: '2 min', imgId: 'Skull_Crusher' },
    ]
  },
  2: { // Tuesday
    name: 'Lower A',
    focus: 'Strength',
    exercises: [
      { name: 'Barbell Squat',        muscle: 'Quads',    sets: 4, reps: '6-8',  tempo: '3-0-1-0', rest: '3 min', imgId: 'Barbell_Squat' },
      { name: 'Romanian Deadlift',    muscle: 'Hamstrings', sets: 4, reps: '6-8', tempo: '3-0-1-0', rest: '3 min', imgId: 'Romanian_Deadlift' },
      { name: 'Leg Press',            muscle: 'Quads',    sets: 3, reps: '8-10', tempo: '3-0-1-0', rest: '2.5 min', imgId: 'Leg_Press' },
      { name: 'Walking Lunges',       muscle: 'Glutes',   sets: 3, reps: '10-12', tempo: '2-0-1-0', rest: '2 min', imgId: 'Barbell_Walking_Lunge' },
      { name: 'Calf Raises',          muscle: 'Calves',   sets: 4, reps: '12-15', tempo: '2-1-1-1', rest: '90 sec', imgId: 'Standing_Calf_Raises' },
      { name: 'Plank',                muscle: 'Core',     sets: 3, reps: '45s',  tempo: '-',       rest: '60 sec', imgId: 'Plank' },
    ]
  },
  4: { // Thursday
    name: 'Upper B',
    focus: 'Hypertrophy',
    exercises: [
      { name: 'Incline Dumbbell Press',   muscle: 'Chest',     sets: 4, reps: '10-12', tempo: '3-0-1-0', rest: '90 sec', imgId: 'Incline_Dumbbell_Press' },
      { name: 'Lat Pulldown',             muscle: 'Back',      sets: 4, reps: '10-12', tempo: '3-0-1-0', rest: '90 sec', imgId: 'Wide-Grip_Lat_Pulldown' },
      { name: 'Dumbbell Shoulder Press',  muscle: 'Shoulders', sets: 3, reps: '10-12', tempo: '3-0-1-0', rest: '90 sec', imgId: 'Dumbbell_Shoulder_Press' },
      { name: 'Dumbbell Flyes',           muscle: 'Chest',     sets: 3, reps: '12-15', tempo: '3-0-1-0', rest: '60 sec', imgId: 'Dumbbell_Flyes' },
      { name: 'Face Pulls',               muscle: 'Rear Delt', sets: 3, reps: '15-20', tempo: '2-1-1-0', rest: '60 sec', imgId: 'Face_Pull' },
      { name: 'Hammer Curls',             muscle: 'Biceps',    sets: 3, reps: '12-15', tempo: '3-0-1-0', rest: '60 sec', imgId: 'Hammer_Curls' },
      { name: 'Cable Tricep Pushdowns',   muscle: 'Triceps',   sets: 3, reps: '12-15', tempo: '3-0-1-0', rest: '60 sec', imgId: 'Pushdown' },
    ]
  },
  6: { // Saturday
    name: 'Lower B',
    focus: 'Hypertrophy',
    exercises: [
      { name: 'Deadlift',               muscle: 'Full Body',  sets: 4, reps: '6-8',  tempo: '3-0-1-0', rest: '3 min', imgId: 'Deadlift' },
      { name: 'Bulgarian Split Squats', muscle: 'Glutes',     sets: 3, reps: '10-12', tempo: '3-0-1-0', rest: '2 min', imgId: 'Barbell_Bulgarian_Split_Squat' },
      { name: 'Leg Curls',              muscle: 'Hamstrings', sets: 3, reps: '12-15', tempo: '3-0-1-0', rest: '90 sec', imgId: 'Lying_Leg_Curls' },
      { name: 'Leg Press',              muscle: 'Quads',      sets: 3, reps: '15-20', tempo: '2-0-1-0', rest: '90 sec', imgId: 'Leg_Press' },
      { name: 'Calf Raises',            muscle: 'Calves',     sets: 4, reps: '15-20', tempo: '2-1-1-1', rest: '60 sec', imgId: 'Standing_Calf_Raises' },
      { name: 'Hanging Leg Raises',     muscle: 'Core',       sets: 3, reps: '12-15', tempo: '2-0-1-0', rest: '60 sec', imgId: 'Hanging_Leg_Raise' },
      { name: 'Russian Twists',         muscle: 'Core',       sets: 3, reps: '20-30', tempo: '1-0-1-0', rest: '60 sec', imgId: 'Russian_Twist' },
    ]
  }
};

const IMG_BASE = 'https://raw.githubusercontent.com/yuhonas/free-exercise-db/main/exercises/';
const MUSCLE_ICONS = {
  'Chest':'ðŸ’ª','Back':'ðŸ”™','Shoulders':'ðŸ‹ï¸','Biceps':'ðŸ’ª','Triceps':'ðŸ’ª',
  'Quads':'ðŸ¦µ','Hamstrings':'ðŸ¦µ','Glutes':'ðŸ‘','Calves':'ðŸ¦¶',
  'Core':'âš¡','Rear Delt':'ðŸŽ¯','Full Body':'ðŸ”¥'
};

// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const today = new Date();
const dow = today.getDay(); // 0=Sun,1=Mon,...,6=Sat
const todayStr = today.toISOString().split('T')[0];
const workout = WORKOUTS[dow] || null;

// â”€â”€ LocalStorage helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getLogs() { return JSON.parse(localStorage.getItem('gymLogs') || '[]'); }
function saveLogs(logs) { localStorage.setItem('gymLogs', JSON.stringify(logs)); }

function logSet(exercise, setIdx, weight, reps) {
  const logs = getLogs();
  // Remove any existing entry for this exercise+set+today
  const filtered = logs.filter(l =>
    !(l.date === todayStr && l.exercise === exercise && l.setIdx === setIdx)
  );
  filtered.push({ date: todayStr, workout: workout?.name, exercise, setIdx, weight: parseFloat(weight), reps: parseInt(reps), ts: Date.now() });
  saveLogs(filtered);
}

function getPrevBest(exerciseName) {
  const logs = getLogs()
    .filter(l => l.exercise === exerciseName && l.date !== todayStr && l.weight > 0)
    .sort((a,b) => b.date.localeCompare(a.date));
  if (!logs.length) return null;
  // Most recent session's max weight
  const latestDate = logs[0].date;
  const latestLogs = logs.filter(l => l.date === latestDate);
  const maxWeight = Math.max(...latestLogs.map(l => l.weight));
  return { date: latestDate, weight: maxWeight };
}

function getTodayLogs(exerciseName) {
  return getLogs().filter(l => l.date === todayStr && l.exercise === exerciseName);
}

// â”€â”€ Tab switching â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function switchTab(tab) {
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('view-' + tab).classList.add('active');
  document.getElementById('nav-' + tab).classList.add('active');
  if (tab === 'history') renderHistory();
}

// â”€â”€ Render today â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderToday() {
  const dateStr = today.toLocaleDateString('en-GB', { weekday:'long', day:'numeric', month:'long' });
  document.getElementById('todayDate').textContent = dateStr;

  if (!workout) {
    document.getElementById('workoutTitle').textContent = 'Rest Day';
    document.getElementById('workoutBadge').style.display = 'none';
    document.getElementById('todayContent').innerHTML = `
      <div class="rest-screen">
        <div class="emoji">ðŸ˜´</div>
        <h2>Recovery Day</h2>
        <p>Rest is where the gains happen.<br>Eat well, sleep well, come back stronger.</p>
      </div>`;
    return;
  }

  document.getElementById('workoutTitle').textContent = workout.name;
  document.getElementById('workoutBadge').textContent = workout.focus;

  const totalSets = workout.exercises.reduce((s,e) => s + e.sets, 0);
  const totalExercises = workout.exercises.length;

  let html = `
    <div class="summary-bar">
      <div class="summary-stat">
        <div class="val">${totalExercises}</div>
        <div class="lbl">Exercises</div>
      </div>
      <div class="summary-stat">
        <div class="val">${totalSets}</div>
        <div class="lbl">Total Sets</div>
      </div>
      <div class="summary-stat">
        <div class="val">45-60</div>
        <div class="lbl">Minutes</div>
      </div>
    </div>`;

  workout.exercises.forEach((ex, exIdx) => {
    const prev = getPrevBest(ex.name);
    const todayLogged = getTodayLogs(ex.name);
    const icon = MUSCLE_ICONS[ex.muscle] || 'ðŸ’ª';

    // Build set rows
    let setRowsHtml = '';
    for (let s = 0; s < ex.sets; s++) {
      const logged = todayLogged.find(l => l.setIdx === s);
      const isDone = !!logged;
      setRowsHtml += `
        <div class="set-row" id="setrow-${exIdx}-${s}">
          <div class="set-num">S${s+1}</div>
          <input class="set-input" type="number" inputmode="decimal" placeholder="kg"
            id="w-${exIdx}-${s}" value="${logged ? logged.weight : ''}">
          <input class="set-input" type="number" inputmode="numeric" placeholder="reps"
            id="r-${exIdx}-${s}" value="${logged ? logged.reps : ''}">
          <button class="set-done-btn ${isDone ? 'logged' : ''}"
            id="btn-${exIdx}-${s}"
            onclick="logSetUI(${exIdx}, ${s}, '${ex.name}')">
            ${isDone ? 'âœ“' : 'â—‹'}
          </button>
        </div>`;
    }

    const loggedCount = todayLogged.length;
    const progressPct = Math.round((loggedCount / ex.sets) * 100);

    html += `
      <div class="exercise-card">
        <img class="exercise-img"
          src="${IMG_BASE}${ex.imgId}/images/0.jpg"
          alt="${ex.name}"
          onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'">
        <div class="exercise-img-placeholder" style="display:none">${icon}</div>
        <div class="exercise-body">
          <div class="exercise-header">
            <div class="exercise-name">${ex.name}</div>
            <div class="muscle-badge">${ex.muscle}</div>
          </div>
          <div class="exercise-meta">
            <div class="meta-chip"><span>${ex.sets}</span> sets</div>
            <div class="meta-chip"><span>${ex.reps}</span> reps</div>
            <div class="meta-chip">Tempo <span>${ex.tempo}</span></div>
            <div class="meta-chip">Rest <span>${ex.rest}</span></div>
          </div>
          ${prev ? `
          <div class="prev-best">
            <span>Previous best:</span>
            <span class="val">${prev.weight} kg</span>
            <span>on ${new Date(prev.date).toLocaleDateString('en-GB',{day:'numeric',month:'short'})}</span>
          </div>` : '<div class="prev-best" style="color:var(--sub)">No previous logs â€” first time! ðŸ”¥</div>'}
          <div class="sets-header">
            <span>Set</span><span>Weight</span><span>Reps</span><span></span>
          </div>
          ${setRowsHtml}
          <button class="add-set-btn" onclick="addSet(${exIdx}, '${ex.name}')">+ Add Set</button>
          <div class="progress-bar-wrap">
            <div class="progress-bar-label">
              <span>Progress</span>
              <span id="prog-label-${exIdx}">${loggedCount}/${ex.sets} sets</span>
            </div>
            <div class="progress-bar-track">
              <div class="progress-bar-fill" id="prog-${exIdx}" style="width:${progressPct}%"></div>
            </div>
          </div>
        </div>
      </div>`;
  });

  document.getElementById('todayContent').innerHTML = html;
}

// â”€â”€ Set logging UI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function logSetUI(exIdx, setIdx, exerciseName) {
  const weight = document.getElementById(`w-${exIdx}-${setIdx}`).value;
  const reps = document.getElementById(`r-${exIdx}-${setIdx}`).value;
  if (!weight && !reps) return;

  logSet(exerciseName, setIdx, weight || 0, reps || 0);

  const btn = document.getElementById(`btn-${exIdx}-${setIdx}`);
  btn.classList.add('logged');
  btn.textContent = 'âœ“';

  // Update progress bar
  updateProgress(exIdx, exerciseName);
}

function updateProgress(exIdx, exerciseName) {
  const ex = workout.exercises[exIdx];
  const logged = getTodayLogs(exerciseName);
  const pct = Math.round((logged.length / ex.sets) * 100);
  const bar = document.getElementById(`prog-${exIdx}`);
  const lbl = document.getElementById(`prog-label-${exIdx}`);
  if (bar) bar.style.width = pct + '%';
  if (lbl) lbl.textContent = `${logged.length}/${ex.sets} sets`;
}

// Extra set tracking (in-session only)
const extraSets = {};
function addSet(exIdx, exerciseName) {
  if (!extraSets[exIdx]) extraSets[exIdx] = 0;
  extraSets[exIdx]++;
  const ex = workout.exercises[exIdx];
  const newSetIdx = ex.sets + extraSets[exIdx] - 1;
  const container = document.getElementById(`btn-${exIdx}-${ex.sets - 1}`)
    .closest('.exercise-body');
  const addBtn = container.querySelector('.add-set-btn');

  const row = document.createElement('div');
  row.className = 'set-row';
  row.id = `setrow-${exIdx}-${newSetIdx}`;
  row.innerHTML = `
    <div class="set-num">S${newSetIdx + 1}</div>
    <input class="set-input" type="number" inputmode="decimal" placeholder="kg" id="w-${exIdx}-${newSetIdx}">
    <input class="set-input" type="number" inputmode="numeric" placeholder="reps" id="r-${exIdx}-${newSetIdx}">
    <button class="set-done-btn" id="btn-${exIdx}-${newSetIdx}"
      onclick="logSetUI(${exIdx}, ${newSetIdx}, '${exerciseName}')">â—‹</button>`;
  container.insertBefore(row, addBtn);
}

// â”€â”€ Render history â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderHistory() {
  const logs = getLogs();
  const container = document.getElementById('historyContent');

  if (!logs.length) {
    container.innerHTML = `
      <div class="history-empty">
        <div class="emoji">ðŸ“‹</div>
        <p>No workouts logged yet.<br>Complete your first session to see history here.</p>
      </div>`;
    return;
  }

  // Group by date
  const byDate = {};
  logs.forEach(l => {
    if (!byDate[l.date]) byDate[l.date] = {};
    if (!byDate[l.date][l.exercise]) byDate[l.date][l.exercise] = [];
    byDate[l.date][l.exercise].push(l);
  });

  const dates = Object.keys(byDate).sort((a,b) => b.localeCompare(a));
  let html = '';

  dates.forEach(date => {
    const d = new Date(date + 'T12:00:00');
    const dateLabel = d.toLocaleDateString('en-GB', { weekday:'long', day:'numeric', month:'long', year:'numeric' });
    const exercises = byDate[date];
    const exNames = Object.keys(exercises);
    const workoutName = logs.find(l => l.date === date)?.workout || 'Workout';
    const totalSets = Object.values(exercises).reduce((s,sets) => s + sets.length, 0);

    const exerciseDetails = exNames.map(ex => {
      const sets = exercises[ex].sort((a,b) => a.setIdx - b.setIdx);
      const setRows = sets.map(s =>
        `<div class="session-set-row">
          <span class="set-label">Set ${s.setIdx + 1}</span>
          <span class="set-data">${s.weight > 0 ? s.weight + ' kg' : 'â€”'} Ã— ${s.reps > 0 ? s.reps + ' reps' : 'â€”'}</span>
        </div>`
      ).join('');
      return `
        <div class="session-exercise">
          <div class="session-exercise-name">${ex}</div>
          <div class="session-sets">${setRows}</div>
        </div>`;
    }).join('');

    html += `
      <div class="session-group">
        <div class="session-date">${dateLabel}</div>
        <div class="session-card">
          <div class="session-card-header" onclick="toggleSession(this)">
            <div>
              <h3>${workoutName}</h3>
              <div class="session-summary">${exNames.length} exercises Â· ${totalSets} sets logged</div>
            </div>
            <span class="session-chevron">â€º</span>
          </div>
          <div class="session-detail">${exerciseDetails}</div>
        </div>
      </div>`;
  });

  container.innerHTML = html;
}

function toggleSession(header) {
  const chevron = header.querySelector('.session-chevron');
  const detail = header.nextElementSibling;
  chevron.classList.toggle('open');
  detail.classList.toggle('open');
}

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
renderToday();
</script>
</body>
</html>
